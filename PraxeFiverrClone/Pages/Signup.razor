@page "/signup"
@using DataAccessLibrary
@using DataAccessLibrary.Models;
@inject DBManager dbManager;
@inject NavigationManager NavManager;


<h3>Signup</h3>
<br />
<p>Username:</p>
<input type="text" @bind="@UsernameValue" @oninput="@((e) => { UsernameValue=(string)e.Value;})" />
<p>Password:</p>
<input type="password" @bind="@PasswordValue" @oninput="@((e) => { PasswordValue=(string)e.Value;})" />
<p>Confirm password:</p>
<input type="password" @bind="@PasswordValue2" @oninput="@((e) => { PasswordValue2=(string)e.Value;})" />

<br />
<br />

<p style="color:red;">@WarningText</p>
<button @onclick="CreateUser">Sign up</button>

<br />  
<br />

<p>Allready have an account?'</p> <a href="/login">log in</a>

@code {

	private string UsernameValue { get; set; }
	private string PasswordValue { get; set; }
	private string PasswordValue2 { get; set; }

	private string WarningText = "";
	public void CreateUser()
	{
		if (PasswordValue != PasswordValue2)
		{
			WarningText = "The passwords must match!";
			return;
		}
		DBUser? user = new DBUser(UsernameValue, PasswordValue);
		var response = dbManager.SingUpUser(user);
		user = response.Result;
		if (user == null)
		{
			WarningText = response.Message;
			return;
		}
		NavManager.NavigateTo("/login");
	}

}
