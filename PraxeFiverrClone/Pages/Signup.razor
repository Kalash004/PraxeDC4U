@page "/signup"
@using DataAccessLibrary
@using DataAccessLibrary.Models;
@inject DBManager dbManager;
@inject NavigationManager NavManager;
    

<h3>Signup</h3>
<br />
<p>Username:</p>
<input type="text" @bind="@UsernameValue" @oninput="@((e) => { UsernameValue=(string)e.Value;})" />
<p>Password:</p>
<input type="password" @bind="@PasswordValue" @oninput="@((e) => { PasswordValue=(string)e.Value;})" />
<p>Confirm password:</p>
<input type="password" @bind="@PasswordValue2" @oninput="@((e) => { PasswordValue2=(string)e.Value;})" />

<br />
<br />

<p style="color:red;">@WarningText</p>
<button @onclick="CreateUser">Sign up</button>

<br />  
<br />

<p>Allready have an account?'</p> <a href="/login">log in</a>

@code {

    private string UsernameValue { get; set; }
    private string PasswordValue { get; set; }
    private string PasswordValue2 { get; set; }

    private string WarningText = "";
    public void CreateUser() {

        if (PasswordValue == PasswordValue2) {
            try
            {
                DBUser user = new DBUser(UsernameValue, PasswordValue);
                dbManager.SingUpUser(user);
                NavManager.NavigateTo("/login");
            } 
            catch(Exception e)
            {
                WarningText = "username already in use!";
            }
        } else
        {
            WarningText = "the passwords must match!";
        }


    }

}
